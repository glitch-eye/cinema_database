-- === Cleanup and Setup ===
PRINT '--- Cleaning up W_USER table ---';
DELETE FROM W_USER;

-- === INSERT Tests ===
PRINT '--- INSERT TESTS ---';

BEGIN TRY
    EXEC sp_ManageWUser 'I', 1, 'Alice', 'NYC', '2000-01-01', 123456789, 1;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', 1, 'Bob', 'LA', '1990-01-01', 234567890, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', 2, 'Alice', 'LA', '1990-01-01', 345678901, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', NULL, 'Charlie', 'Boston', '1995-01-01', 456789012, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', 3, '   ', 'Chicago', '1995-01-01', 567890123, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', 4, 'David', 'Seattle', '2099-01-01', 678901234, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', 5, 'Eva', 'Houston', '2015-01-01', 789012345, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'I', 6, 'Frank', 'Miami', '1990-01-01', 1234567890, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

-- === UPDATE Tests ===
PRINT '--- UPDATE TESTS ---';

BEGIN TRY
    EXEC sp_ManageWUser 'U', 1, 'Alice_Updated', 'NYC', '2000-01-01', 123456789, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'U', 99, 'Ghost', 'Nowhere', '1990-01-01', 999999999, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

-- Insert user with unique name for collision
BEGIN TRY
    EXEC sp_ManageWUser 'I', 7, 'Henry', 'DC', '1990-01-01', 987654321, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'U', 1, 'Henry', 'NYC', '2000-01-01', 111222333, 1;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'U', 1, 'Alice_Updated', 'NYC', '2090-01-01', 123456789, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'U', 1, 'Alice_Updated', 'NYC', '2000-01-01', 111, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

-- === DELETE Tests ===
PRINT '--- DELETE TESTS ---';

BEGIN TRY
    EXEC sp_ManageWUser 'D', 7, '', NULL, '1990-01-01', 111111111, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

BEGIN TRY
    EXEC sp_ManageWUser 'D', 100, '', NULL, '1990-01-01', 111111111, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH

-- === INVALID OPERATION TEST ===
PRINT '--- INVALID OPERATION CODE TEST ---';

BEGIN TRY
    EXEC sp_ManageWUser 'X', 8, 'InvalidOp', 'Nowhere', '2000-01-01', 999999999, 0;
END TRY BEGIN CATCH PRINT ERROR_MESSAGE(); END CATCH
